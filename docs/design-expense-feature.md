# æ”¯å‡ºè¨˜éŒ²æ©Ÿèƒ½ è¨­è¨ˆæ›¸ï¼ˆPhase 1ï¼‰

## Overview

ã‚°ãƒ«ãƒ¼ãƒ—å†…ã§ç™ºç”Ÿã—ãŸæ”¯å‡ºã‚’è¨˜éŒ²ã—ã€ãƒ¡ãƒ³ãƒãƒ¼é–“ã®è² æ‹…é…åˆ†ã‚’ç®¡ç†ã™ã‚‹æ©Ÿèƒ½ã€‚MVPã®æ ¸ã¨ãªã‚‹æ©Ÿèƒ½ã§ã‚ã‚Šã€ç²¾ç®—æ©Ÿèƒ½ã®åŸºç›¤ã¨ãªã‚‹ã€‚

### Phase 1 ã‚¹ã‚³ãƒ¼ãƒ—

| æ©Ÿèƒ½           | Phase 1 | Phase 2 |
| -------------- | ------- | ------- |
| æ”¯å‡ºç™»éŒ²       | â—¯       | -       |
| æ”¯å‡ºä¸€è¦§è¡¨ç¤º   | â—¯       | -       |
| å‡ç­‰åˆ†å‰²       | â—¯       | -       |
| å‚¾æ–œåˆ†å‰²(å‰²åˆ) | -       | â—¯       |
| å‚¾æ–œåˆ†å‰²(é‡‘é¡) | -       | â—¯       |
| å…¨é¡è² æ‹…       | -       | â—¯       |
| æ”¯å‡ºç·¨é›†       | -       | â—¯       |
| æ”¯å‡ºå‰Šé™¤       | -       | â—¯       |

## Purpose

### ãªãœå¿…è¦ã‹

1. **å…±æœ‰å®¶è¨ˆç°¿ã®åŸºæœ¬æ©Ÿèƒ½**: æ”¯å‡ºã‚’è¨˜éŒ²ã—ãªã„ã¨ã€èª°ãŒã„ãã‚‰æ‰•ã£ã¦èª°ãŒè² æ‹…ã™ã¹ãã‹ã‚’è¿½è·¡ã§ããªã„
2. **ç²¾ç®—æ©Ÿèƒ½ã®å‰æ**: æ”¯å‡ºãƒ‡ãƒ¼ã‚¿ãŒãªã„ã¨ç²¾ç®—è¨ˆç®—ãŒã§ããªã„
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤ã®å³æ™‚æä¾›**: ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆãƒ»å‚åŠ å¾Œã€ã™ãã«æ”¯å‡ºè¨˜éŒ²ã‚’é–‹å§‹ã§ãã‚‹

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦ã€æ”¯å‡ºã‚’è¨˜éŒ²ã—ã¦èª°ãŒæ‰•ã£ãŸã‹ã€èª°ãŒè² æ‹…ã™ã¹ãã‹ã‚’ç®¡ç†ã—ãŸã„
- æ”¯æ‰•è€…ã¨ã—ã¦ã€è‡ªåˆ†ãŒç«‹ã¦æ›¿ãˆãŸé‡‘é¡ã‚’è¨˜éŒ²ã—ã€å¾Œã§ç²¾ç®—ã—ãŸã„
- ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦ã€éå»ã®æ”¯å‡ºä¸€è¦§ã‚’ç¢ºèªã—ãŸã„

## What to Do

### æ©Ÿèƒ½è¦ä»¶ï¼ˆPhase 1ï¼‰

#### 1. æ”¯å‡ºç™»éŒ²

| é …ç›®     | å¿…é ˆ | èª¬æ˜                        |
| -------- | ---- | --------------------------- |
| é‡‘é¡     | â—¯    | 1ã€œ100,000,000å††ï¼ˆæ•´æ•°ï¼‰    |
| ã‚«ãƒ†ã‚´ãƒª | â—¯    | ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰é¸æŠ  |
| æ”¯æ‰•è€…   | â—¯    | ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰é¸æŠ    |
| æ—¥ä»˜     | â—¯    | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å½“æ—¥            |
| ãƒ¡ãƒ¢     | Ã—    | è‡ªç”±å…¥åŠ›ï¼ˆ500æ–‡å­—ä»¥å†…ï¼‰     |
| è² æ‹…æ–¹æ³• | -    | **Phase 1ã§ã¯å‡ç­‰åˆ†å‰²å›ºå®š** |

#### 2. è² æ‹…æ–¹æ³•ï¼ˆPhase 1: å‡ç­‰åˆ†å‰²ã®ã¿ï¼‰

```mermaid
flowchart TD
    A[æ”¯å‡ºç™»éŒ²] --> B[equal: äººæ•°ã§ç­‰åˆ†]
    B --> C[ç«¯æ•°ã¯æ”¯æ‰•è€…ãŒè² æ‹…]
```

**å‡ç­‰åˆ†å‰²ã®ä¾‹ï¼ˆ1000å††ã€A/B/Cã®3äººã‚°ãƒ«ãƒ¼ãƒ—ã€AãŒæ”¯æ‰•ã„ï¼‰**:

| æ–¹æ³•  | è¨ˆç®—                               | çµæœ                |
| ----- | ---------------------------------- | ------------------- |
| equal | 1000 Ã· 3 = 333ä½™ã‚Š1ã€ç«¯æ•°ã¯æ”¯æ‰•è€…A | A:334, B:333, C:333 |

> **Phase 2ã§è¿½åŠ äºˆå®š**: ratioï¼ˆå‰²åˆæŒ‡å®šï¼‰, amountï¼ˆé‡‘é¡æŒ‡å®šï¼‰, fullï¼ˆå…¨é¡è² æ‹…ï¼‰

#### 3. æ”¯å‡ºä¸€è¦§è¡¨ç¤º

- **ã‚°ãƒ«ãƒ¼ãƒ—è©³ç´°ãƒšãƒ¼ã‚¸ã«çµ±åˆ**ã—ã¦è¡¨ç¤º
- ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®æ”¯å‡ºã‚’æ—¥ä»˜é™é †ã§è¡¨ç¤º
- å„æ”¯å‡ºã®è©³ç´°æƒ…å ±ï¼ˆé‡‘é¡ã€ã‚«ãƒ†ã‚´ãƒªã€æ”¯æ‰•è€…ã€è² æ‹…é…åˆ†ï¼‰ã‚’è¡¨ç¤º

#### 4. æ”¯å‡ºç·¨é›†ãƒ»å‰Šé™¤ï¼ˆPhase 2ï¼‰

> Phase 1ã§ã¯ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã€‚Phase 2ã§å®Ÿè£…äºˆå®šã€‚

### éæ©Ÿèƒ½è¦ä»¶

- **UXç›®æ¨™**: 3ã‚¿ãƒƒãƒ—ä»¥å†…ã§æ”¯å‡ºç™»éŒ²å®Œäº†
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: Optimistic UIã§å³åº§ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹
- **ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: ã‚¹ãƒãƒ›ã§ã®å…¥åŠ›ã«æœ€é©åŒ–
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ**: ä»–ãƒ¡ãƒ³ãƒãƒ¼ã®æ”¯å‡ºãŒå³åº§ã«åæ˜ 

## How to Do It

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant U as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant F as Frontend
    participant C as Convex
    participant DB as Database

    U->>F: æ”¯å‡ºæƒ…å ±å…¥åŠ›
    F->>F: ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    F->>C: expenses.create mutation
    C->>C: èªè¨¼ãƒã‚§ãƒƒã‚¯
    C->>C: ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ç¢ºèª
    C->>C: è² æ‹…é…åˆ†è¨ˆç®—
    C->>DB: Expenseä¿å­˜
    C->>DB: ExpenseSplitä¿å­˜ï¼ˆè¤‡æ•°ï¼‰
    C-->>F: æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    F->>F: Optimistic UIæ›´æ–°
    Note over F,DB: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã§ä»–ãƒ¡ãƒ³ãƒãƒ¼ã«ã‚‚åæ˜ 
```

### ç”»é¢æ§‹æˆï¼ˆãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰

#### æ”¯å‡ºç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  æ”¯å‡ºã‚’è¨˜éŒ²                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  é‡‘é¡                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Â¥ 1,500                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  ã‚«ãƒ†ã‚´ãƒª                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ½ï¸ é£Ÿè²»               â–¼ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  æ”¯æ‰•è€…                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¤ è‡ªåˆ†                â–¼ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  æ—¥ä»˜                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“… 2024-12-30          â–¼ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â€» å‡ç­‰åˆ†å‰²ã§è² æ‹…é…åˆ†ã•ã‚Œã¾ã™  â”‚
â”‚                                 â”‚
â”‚  ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ãƒ©ãƒ³ãƒä»£                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      è¨˜éŒ²ã™ã‚‹            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ”¯å‡ºä¸€è¦§ç”»é¢ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—è©³ç´°ãƒšãƒ¼ã‚¸ã«çµ±åˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ†ã‚¹ãƒˆå®¶è¨ˆç°¿ã‚°ãƒ«ãƒ¼ãƒ—           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€ 2024å¹´12æœˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ½ï¸ é£Ÿè²»        Â¥1,500   â”‚   â”‚
â”‚  â”‚ Aã•ã‚“ãŒæ”¯æ‰•ã„            â”‚   â”‚
â”‚  â”‚ 12/30 ãƒ» ãƒ©ãƒ³ãƒä»£        â”‚   â”‚
â”‚  â”‚ å‡ç­‰åˆ†å‰² (A:500 B:500...)â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ§´ æ—¥ç”¨å“      Â¥2,400   â”‚   â”‚
â”‚  â”‚ Bã•ã‚“ãŒæ”¯æ‰•ã„            â”‚   â”‚
â”‚  â”‚ 12/29 ãƒ» ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ç­‰    â”‚   â”‚
â”‚  â”‚ å‡ç­‰åˆ†å‰² (A:800 B:800...)â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€ 2024å¹´11æœˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  ...                            â”‚
â”‚                                 â”‚
â”‚                     [ï¼‹]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼ˆPhase 1ï¼‰

```
app/
â””â”€â”€ groups/
    â””â”€â”€ [groupId]/
        â”œâ”€â”€ page.tsx                    # ã‚°ãƒ«ãƒ¼ãƒ—è©³ç´°ï¼ˆæ”¯å‡ºä¸€è¦§ã‚’çµ±åˆï¼‰
        â””â”€â”€ expenses/
            â””â”€â”€ new/
                â””â”€â”€ page.tsx            # æ”¯å‡ºç™»éŒ²

components/
â””â”€â”€ expenses/
    â”œâ”€â”€ ExpenseForm.tsx                 # æ”¯å‡ºç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 
    â”œâ”€â”€ ExpenseList.tsx                 # æ”¯å‡ºä¸€è¦§
    â””â”€â”€ ExpenseCard.tsx                 # æ”¯å‡ºã‚«ãƒ¼ãƒ‰

convex/
â”œâ”€â”€ expenses.ts                         # æ”¯å‡ºé–¢é€£ã®mutation/query
â””â”€â”€ lib/
    â””â”€â”€ splitCalculator.ts              # è² æ‹…é…åˆ†è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```

> **Phase 2ã§è¿½åŠ äºˆå®š**: `SplitMethodSelector.tsx`, `RatioSplitInput.tsx`, `AmountSplitInput.tsx`

### Convexé–¢æ•°ï¼ˆPhase 1ï¼‰

#### expenses.ts

```typescript
// æ”¯å‡ºç™»éŒ²ï¼ˆPhase 1: å‡ç­‰åˆ†å‰²ã®ã¿ï¼‰
export const create = authMutation({
  args: {
    groupId: v.id("groups"),
    amount: v.number(),
    categoryId: v.id("categories"),
    paidBy: v.id("users"),
    date: v.string(),
    memo: v.optional(v.string()),
    // Phase 1ã§ã¯ splitMethod ã¯å¸¸ã« "equal"
  },
  handler: async (ctx, args) => {
    // 1. ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼ç¢ºèª
    // 2. å‡ç­‰åˆ†å‰²ã§è² æ‹…é…åˆ†è¨ˆç®—
    // 3. Expenseä¿å­˜
    // 4. ExpenseSplitä¿å­˜
    return expenseId;
  },
});

// æ”¯å‡ºä¸€è¦§å–å¾—
export const listByGroup = authQuery({
  args: {
    groupId: v.id("groups"),
    limit: v.optional(v.number()),
  },
  handler: async (ctx, args) => {
    // ã‚°ãƒ«ãƒ¼ãƒ—ã®æ”¯å‡ºã‚’æ—¥ä»˜é™é †ã§å–å¾—
    // ã‚«ãƒ†ã‚´ãƒªã€æ”¯æ‰•è€…ã€è² æ‹…é…åˆ†ã‚‚å«ã‚ã¦è¿”ã™
  },
});

// æ”¯å‡ºè©³ç´°å–å¾—
export const getById = authQuery({
  args: { expenseId: v.id("expenses") },
  handler: async (ctx, args) => {
    // æ”¯å‡ºè©³ç´°ã¨è² æ‹…é…åˆ†ã‚’å–å¾—
  },
});
```

> **Phase 2ã§è¿½åŠ äºˆå®š**: `update`, `remove` mutation

### è² æ‹…é…åˆ†è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆPhase 1ï¼‰

```typescript
// convex/lib/splitCalculator.ts

interface SplitResult {
  userId: Id<"users">;
  amount: number;
}

/**
 * å‡ç­‰åˆ†å‰²ï¼ˆç«¯æ•°ã¯æ”¯æ‰•è€…ãŒè² æ‹…ï¼‰
 * Phase 1ã§ã¯ã“ã®é–¢æ•°ã®ã¿å®Ÿè£…
 */
export function calculateEqualSplit(
  amount: number,
  memberIds: Id<"users">[],
  payerId: Id<"users">,
): SplitResult[] {
  const count = memberIds.length;
  const base = Math.floor(amount / count);
  const remainder = amount % count;

  return memberIds.map((userId) => ({
    userId,
    amount: userId === payerId ? base + remainder : base,
  }));
}
```

> **Phase 2ã§è¿½åŠ äºˆå®š**: `calculateRatioSplit`, `calculateAmountSplit`, `calculateFullSplit`

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ï¼ˆPhase 1ï¼‰

```typescript
// é‡‘é¡
const amountValidation = {
  min: 1,
  max: 100_000_000,
  integer: true,
};

// ãƒ¡ãƒ¢
const memoValidation = {
  maxLength: 500,
};

// æ—¥ä»˜
const dateValidation = {
  format: "YYYY-MM-DD",
  maxFuture: 0, // æœªæ¥æ—¥ã¯ä¸å¯
};
```

> **Phase 2ã§è¿½åŠ äºˆå®š**: è² æ‹…é…åˆ†ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆratio: åˆè¨ˆ100%, amount: åˆè¨ˆä¸€è‡´, full: 1äººæŒ‡å®šï¼‰

## What We Won't Do

### Phase 1 ã‚¹ã‚³ãƒ¼ãƒ—å¤–ï¼ˆPhase 2ã§å®Ÿè£…äºˆå®šï¼‰

1. **å‚¾æ–œåˆ†å‰²ï¼ˆå‰²åˆæŒ‡å®šï¼‰**: 70%/30%ã®ã‚ˆã†ãªå‰²åˆæŒ‡å®šã«ã‚ˆã‚‹è² æ‹…é…åˆ†
2. **å‚¾æ–œåˆ†å‰²ï¼ˆé‡‘é¡æŒ‡å®šï¼‰**: ç‰¹å®šé‡‘é¡ã‚’ç›´æ¥æŒ‡å®šã™ã‚‹è² æ‹…é…åˆ†
3. **å…¨é¡è² æ‹…**: 1äººãŒå…¨é¡ã‚’è² æ‹…ã™ã‚‹è² æ‹…é…åˆ†
4. **æ”¯å‡ºç·¨é›†**: ç™»éŒ²æ¸ˆã¿æ”¯å‡ºã®ç·¨é›†æ©Ÿèƒ½
5. **æ”¯å‡ºå‰Šé™¤**: ç™»éŒ²æ¸ˆã¿æ”¯å‡ºã®å‰Šé™¤æ©Ÿèƒ½

### MVPå¤–ï¼ˆä»Šå¾Œã®æ¤œè¨äº‹é …ï¼‰

1. **ãƒ¬ã‚·ãƒ¼ãƒˆOCR**: ç”»åƒã‹ã‚‰é‡‘é¡ãƒ»ã‚«ãƒ†ã‚´ãƒªã‚’è‡ªå‹•èª­ã¿å–ã‚Šï¼ˆå®Ÿè£…ã‚³ã‚¹ãƒˆé«˜ï¼‰
2. **å®šæœŸæ”¯å‡º**: æ¯æœˆåŒã˜æ”¯å‡ºã‚’è‡ªå‹•ç™»éŒ²
3. **æ”¯å‡ºãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: ã‚ˆãä½¿ã†æ”¯å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä¿å­˜
4. **è¤‡æ•°é€šè²¨å¯¾å¿œ**: å††ä»¥å¤–ã®é€šè²¨
5. **æ”¯å‡ºã®åˆ†å‰²ç™»éŒ²**: 1å›ã®è²·ã„ç‰©ã‚’è¤‡æ•°ã‚«ãƒ†ã‚´ãƒªã«åˆ†å‰²

### ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æ›´æ–°

ä»Šå›ã®å®Ÿè£…ã§ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ãŒ**å¿…è¦**ã€‚

- ãƒ†ã‚¹ãƒˆç”¨ã®æ”¯å‡ºãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
- Phase 1ã§ã¯å‡ç­‰åˆ†å‰²ï¼ˆequalï¼‰ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ã¿

## Concerns

### æ‡¸å¿µäº‹é …ã¨å¯¾ç­–ï¼ˆPhase 1ï¼‰

| æ‡¸å¿µ                        | å¯¾ç­–                                 |
| --------------------------- | ------------------------------------ |
| å‡ç­‰åˆ†å‰²ã®ç«¯æ•°å‡¦ç†ãƒŸã‚¹      | ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã§æ¤œè¨¼                 |
| Optimistic UIã¨å®Ÿéš›ã®ä¸æ•´åˆ | ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè£…     |
| å¤§é‡ã®æ”¯å‡ºãƒ‡ãƒ¼ã‚¿ã§ã®æ€§èƒ½    | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ´»ç”¨ |

> Phase 1ã§ã¯ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½ãŒãªã„ãŸã‚ã€èª¤ç™»éŒ²æ™‚ã¯ç²¾ç®—å‰ã«å¯¾å‡¦ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

### è¨­è¨ˆåˆ¤æ–­

1. **ç«¯æ•°å‡¦ç†**: æ”¯æ‰•è€…ãŒç«¯æ•°ã‚’è² æ‹…ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãƒ»å…¬å¹³ï¼‰
2. **æœªæ¥æ—¥ã®æ”¯å‡º**: è¨±å¯ã—ãªã„ï¼ˆäºˆå®šæ©Ÿèƒ½ã¯åˆ¥é€”æ¤œè¨ï¼‰
3. **è² æ‹…é…åˆ†**: Phase 1ã§ã¯å‡ç­‰åˆ†å‰²ã®ã¿ï¼ˆæœ€ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹ï¼‰

> **Phase 2ã§æ±ºå®šäºˆå®š**: æ”¯å‡ºã®ç·¨é›†ãƒ»å‰Šé™¤æ¨©é™ï¼ˆç™»éŒ²è€…ã®ã¿ or ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ï¼‰

## Reference Materials/Information

- æ—¢å­˜ã‚¹ã‚­ãƒ¼ãƒ: `convex/schema.ts` - expenses, expenseSplits ãƒ†ãƒ¼ãƒ–ãƒ«
- ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«: `docs/design-domain-model.md` - è² æ‹…é…åˆ†ãƒ­ã‚¸ãƒƒã‚¯è©³ç´°
- æ—¢å­˜å®Ÿè£…: `convex/groups.ts` - authMutationã®ä½¿ã„æ–¹å‚è€ƒ
- MVPä»•æ§˜: `docs/mvp-features.md` - æ”¯å‡ºè¨˜éŒ²ã®è¦ä»¶
