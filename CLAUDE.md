# Oaiko（おあいこ）

共有家計簿Webアプリ。Sharerooを参考に、Web版として開発。

## プロジェクト概要

- **プロダクト名**: Oaiko（おあいこ）
- **名前の由来**: お相子 = 精算して貸し借りなし
- **コンセプト**: 割り勘・傾斜折半ができる共有家計簿
- **ターゲット**: 同棲カップル、夫婦、シェアハウス住人
- **差別化**: 割り勘・傾斜折半 + プラットフォーム非依存（Web）

## 方針

### プラットフォーム

- **Webアプリ**で可能な限り最高のUXを目指す
- ネイティブではなくWebを選んだ理由:
  - Sharerooにない「プラットフォーム非依存」という差別化
  - 個人開発として現実的なスコープ
  - URLで招待できる（アプリインストール不要）

### 設計方針

- ドメインモデルをちゃんと組む
- テストをちゃんと書く
- シンプルな機能で最高のUX

### 実装方針

- **シンプルさを追求**: 複雑な実装より、シンプルな解決策を選ぶ
- **実装後レビュー**: 一度実装した後、必ず見直してリファクタリング改善ポイントをチェックする
  - より簡潔に書けないか？
  - 不要な複雑さはないか？
  - 組み込み機能やサービス提供の機能で代替できないか？
- 例: Vercel CLI複雑な認証回避 → Deploy Hook（シンプル）

### UX指針

1. モバイルファースト徹底（デスクトップは後回し）
2. 入力UX最優先（目標: 3タップ以内で記録完了）
3. PWA対応必須
4. パフォーマンス重視（初期ロード3秒以内、Optimistic UI）
5. オフライン対応は段階的に
6. 将来のネイティブ化（Capacitor等）を視野に

## MVP要件

詳細は `docs/mvp-features.md` を参照。

### 機能一覧

- 支出記録（金額、カテゴリ、支払者、日付、メモ）
- 負担方法（均等 / 傾斜（割合・金額） / 全額負担）
- グループ・メンバー（Nグループ、M人対応）
- カテゴリ（プリセット + カスタム追加）
- 精算（月ごと表示、精算済み/未精算ステータス）
- 分析（カテゴリ別円グラフ、月別推移）
- 買い物リスト（グループ共有、支出連携、履歴表示）

### MVP外

- レシートOCR
- 通知機能
- 収入記録

## 技術スタック

```
Frontend: Next.js (App Router)
Backend: Convex (DB + API + リアルタイム同期)
Auth: Clerk or Convex Auth（未決定）
Deploy: Vercel + Convex
```

### 選定理由

- リアルタイム同期が組み込み（共有家計簿に最適）
- Optimistic UIがデフォルト（サクサク動作）
- IaC不要でアプリコードに集中できる

詳細は `docs/tech-selection.md` を参照。

## ドキュメント

- `HANDOVER.md` - セッション引き継ぎ書（現在のステータス・次のステップ）
- `docs/tech-selection.md` - 技術選定の比較検討・決定事項
- `docs/mvp-features.md` - MVP機能仕様

## 開発フロー

### ローカル開発

```bash
# 開発サーバー起動（Next.js + Convex同時起動）
pnpm dev
```

### デプロイ

**重要: デプロイはPRマージで行う**

1. featureブランチを作成して作業
2. PRを作成 → CI（lint, format, typecheck, build）が自動実行
3. CIパス確認後、mainにマージ
4. マージ後、Deployワークフローが自動実行（Convex → Vercel）
5. **CI/CDが正常終了したことを必ず確認する**

```bash
# ワークフロー実行状況確認
gh run list --limit 3

# 特定のワークフロー監視
gh run watch <run-id>
```

### CI/CD構成

- **CI** (PR時): lint, format, typecheck, build を並列実行
- **Deploy** (main push時): Convex → Vercel を順次実行

### その他コマンド

```bash
# lint
pnpm lint

# フォーマット
pnpm format

# 型チェック
pnpm typecheck

# Convex手動デプロイ（通常は不要）
pnpm dlx convex deploy --yes
```
